import{r as a,a as B,j as e,X as G,B as L,p as C,u as M}from"./index-nRz7PDd4.js";import{T as V,a as H,b as I,c as _}from"./tabs-86dbQy6C.js";/* empty css                        */import{b as z}from"./bid.service-0Dku6ybv.js";import{R as O,S as E}from"./CustomSkeletons-D9FdukaD.js";import{I as W}from"./index.es-BDO_WAak.js";import{R as X,s as F}from"./sortByDate-HaxCvm8q.js";import{T as $}from"./TooltipComp-eQaeTgpE.js";import{M as J}from"./move-right-QR2Ye0kV.js";import{A as K}from"./AlertPopup-DJCRSOvE.js";import{L as Q}from"./list-filter-CR24f6YA.js";import"./index-7tktKguZ.js";import"./react-CfDFl5mw.js";import"./dateFormatter-CQy79qr9.js";import"./index-CppV2h3m.js";import"./alert-dialog-DvHQnZ2k.js";const k=({state:n,target:o,limit:D,tab:c="",setState:R,setSelectedTileId:h,setOpen:q})=>{const[u,p]=a.useState([]),[v,m]=a.useState(1),[j,d]=a.useState(!0),g=a.useRef(!1),f=a.useRef(!1),y=B(),x=async(t,r)=>{if(o==="requirements")return await z.getMyRequirements(t,r);if(o==="drafts")return await C.getDrafts(t,r)};a.useEffect(()=>{Array.isArray(n?.data)&&(p(n.data),g.current||(m(n.page),d(n.page<n.totalPages),g.current=!0))},[n.data]),a.useEffect(()=>()=>{g.current=!1,f.current=!1},[o]);const A=async()=>{if(!(!j||f.current)){f.current=!0;try{const t=v+1;let r=await x(t,D);r?.data&&r.data.length>0?(p(w=>{const S=new Set(w.map(s=>s._id)),T=r.data.filter(s=>!S.has(s._id)),b=[...w,...T];return R(s=>({...s,data:b,page:t,totalPages:r.totalPages})),b}),m(t),d(t<r.totalPages)):(console.log("No more data available"),d(!1))}catch(t){console.error("Error fetching next page:",t),d(!1)}finally{f.current=!1}}};return e.jsx(W,{dataLength:u.length,next:A,hasMore:j,loader:new Array(3).fill(0).map((t,r)=>e.jsx(O,{},r)),className:"grid grid-cols-1 gap-4",children:u?.map((t,r)=>e.jsxs("div",{className:"border-2 border-gray-300 p-4 rounded-md w-full relative",children:[o==="drafts"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-2 right-2 z-10 bg-orange-100 text-orange-500 rounded-sm  p-1 cursor-pointer",onClick:()=>{console.log(t),q?.(!0),h?.(t._id)},children:e.jsx($,{hoverChildren:e.jsx(G,{className:"h-4 w-4"}),contentChildren:e.jsx("p",{children:"Delete Draft"})})}),e.jsxs(L,{className:"absolute bottom-5 right-5 z-10 cursor-pointer text-xs  bc",onClick:()=>y("/update-draft/"+t._id),size:"default",children:["Edit Draft",e.jsx(J,{className:"w-5 h-5"})]})]}),e.jsx("div",{onClick:()=>{},children:e.jsx(X,{product:t,target:o,tab:c})})]},t._id||r))})},N=10,me=()=>{const[n,o]=a.useState("requirements"),{fn:D,data:c,loading:R,setData:h}=M(C.getDrafts),{fn:q,data:u,loading:p}=M(C.deleteDraft),{fn:v,data:m,loading:j,setData:d}=M(z.getMyRequirements),[g,f]=a.useState([]),[y,x]=a.useState(null),[A,t]=a.useState(!1),[r,w]=a.useState(!1),S={title:"Warning",message:`This action cannot be undone. This ${n==="requirements"?"Requirement":"Draft"} will permanently delete your account.`};a.useEffect(()=>{n==="requirements"?v(1,N):D(1,N)},[n]),a.useEffect(()=>{c&&c?.data?.length>0&&f(c?.data||[])},[c]);const T=()=>{w(s=>{const l=!s;return n==="requirements"?d(i=>{if(!Array.isArray(i?.data))return i;const P=F(i.data,l);return{...i,data:P}}):h(i=>{if(!Array.isArray(i?.data))return i;const P=F(i.data,l);return{...i,data:P}}),l})},b=s=>{n==="requirements"||q(s)};return a.useEffect(()=>{u&&(console.log(u),h(s=>{if(!Array.isArray(s?.data))return s;const l=s.data.filter(i=>i._id!==y);return{...s,data:l}}),x(null))},[u]),e.jsxs(e.Fragment,{children:[e.jsx(K,{loading:p,setOpen:t,open:A,message:S,deleteFunction:()=>{b(y)}}),e.jsx("div",{className:"w-full max-w-7xl mx-auto space-y-6",children:e.jsxs("div",{className:"grid space-y-5 w-full",children:[e.jsxs("div",{className:"flex justify-between items-center font-semibold w-full mb-3",children:[e.jsx("p",{className:"font-bold text-xl whitespace-nowrap tracking-tight text-gray-600",children:"Requirements (Posted / Draft)"}),e.jsxs(L,{onClick:T,variant:"ghost",size:"icon",className:"w-24 flex gap-2 items-center justify-center text-sm font-medium text-gray-700 bg-transparent border-1 hover:bg-transparent cursor-pointer border-gray-700",children:["Date",e.jsx(Q,{className:"w-5 h-5"})]})]}),e.jsxs(V,{defaultValue:"requirements",className:"grid space-y-2 w-full overflow-hidden",onValueChange:s=>o(s),children:[e.jsxs(H,{className:"bg-transparent",children:[e.jsx(I,{value:"requirements",className:"cursor-pointer min-w-32",children:"Posted"}),e.jsx(I,{value:"drafts",className:"cursor-pointer min-w-32",children:"Drafts"})]}),e.jsx(_,{value:"requirements",className:"w-full overflow-hidden",children:j?new Array(5).fill(0).map((s,l)=>e.jsx(E,{},l)):m?.data?.length>0?e.jsx(k,{target:"requirements",state:m,setState:d,limit:N,setSelectedTileId:x,setOpen:t}):e.jsxs("div",{className:"w-full h-[300px] flex flex-col items-center justify-center",children:[e.jsx("img",{src:"/empty-cart.webp",width:"10%",alt:"No data"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No Requirements Found"})]})}),e.jsx(_,{value:"drafts",className:"w-full overflow-hidden",children:R?new Array(5).fill(0).map((s,l)=>e.jsx(E,{},l)):g.length>0?e.jsx(k,{target:"drafts",state:c,limit:N,setSelectedTileId:x,setOpen:t}):e.jsxs("div",{className:"w-full h-[300px] flex flex-col items-center justify-center",children:[e.jsx("img",{src:"/empty-cart.webp",width:"10%",alt:"No data"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No Drafts Found"})]})})]})]})})]})};export{me as default};
