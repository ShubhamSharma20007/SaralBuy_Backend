import{r,a as R,u as y,a8 as V,t as z,j as t,a9 as n,B as W}from"./index-nRz7PDd4.js";import{A as O,a as q,b as G}from"./avatar-CCyh8JC8.js";import{d as v}from"./dateFormatter-CQy79qr9.js";import{b}from"./bid.service-0Dku6ybv.js";import{a as H}from"./CustomSkeletons-D9FdukaD.js";import{T as J}from"./TableLisiting-ByMm-dXm.js";import{A as M}from"./AlertPopup-DJCRSOvE.js";import{T as U}from"./TooltipComp-eQaeTgpE.js";import{f as X}from"./fallBackName-CJO8Y_N6.js";import{m as Y}from"./mergeName-Dsr0uQzc.js";import{T as Z}from"./trash-2-C9C2rXVf.js";import"./index-3zwKqybI.js";import"./alert-dialog-DvHQnZ2k.js";import"./index-CppV2h3m.js";const me=()=>{const[i,c]=r.useState([]),[j,u]=r.useState(!1),[p,m]=r.useState(""),B={title:"Warning",message:"This action cannot be undone. This Quote will permanently delete your account."},N=R(),{fn:D,data:s,loading:A}=y(b.getAllBids),{fn:S,data:g,loading:f}=y(b.deleteBid),[d,w]=r.useState(1),[_,T]=r.useState(0),[l,C]=r.useState(10),[h,I]=r.useState(""),[x,{isPending:K}]=V(h,600);console.log(s,234);const P=[{accessorKey:"avtar",header:"",cell:({row:a})=>t.jsx("div",{className:" ",children:t.jsxs(O,{className:"w-10 h-10",children:[t.jsx(q,{src:a.original.avatar,alt:"product image",className:"rounded-full w-full h-full object-cover"}),t.jsx(G,{className:"bg-gray-200 rounded-full flex w-full h-full  items-center justify-center text-sm font-semibold",children:X(a.original?.product)})]})})},{accessorKey:"date",header:"Date",cell:({row:a})=>t.jsx("span",{className:"whitespace-nowrap text-sm",children:a.getValue("date")})},{accessorKey:"buyer",header:"Buyer"},{accessorKey:"product",header:"Product"},{accessorKey:"your_budget",header:"Quoted Price"},{accessorKey:"delivery",header:"Delivery",cell:({row:a})=>t.jsx("span",{className:"whitespace-nowrap text-sm",children:a.getValue("date")})},{accessorKey:"location",header:"Location"},{accessorKey:"status",header:"Status",cell:({row:a})=>{const o=a.original?.status?.toLowerCase()==="rejected";return a.original?.status?o?t.jsx(n,{className:"bg-red-100 text-red-500 rounded-full px-2 w-20",children:"Rejected"}):t.jsx(n,{className:"bg-green-100 text-green-500 rounded-full capitalize px-3 w-20",children:a.original?.status}):t.jsx(n,{className:"bg-green-100 text-green-500 rounded-full px-2 w-20",children:"Pending"})}},{accessorKey:"action",header:"Action",cell:({row:a})=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(W,{className:"text-sm cursor-pointer text-gray-600 underline",variant:"link",onClick:()=>{N("/bid-overview/"+a.original?._id)},children:"View"}),t.jsx(U,{hoverChildren:t.jsx("div",{onClick:()=>{f||(m(a.original?._id),u(!0))},className:"hover:bg-red-100 p-1 rounded-md ease-in-out transition-all duration-300",children:t.jsx(Z,{className:"h-4 w-4  text-red-500 cursor-pointer rounded-full"})}),contentChildren:t.jsx("p",{children:"Delete Quote"})})]})}];r.useEffect(()=>{D(l,d,x)},[l,d,x]),r.useEffect(()=>{if(s){const{bids:a,total:o,limit:L}=s,k=a.map(e=>{let E=e.product?.product?._id||e.product?._id,Q=e.product?.product?.userId||e.product?.userId;return new Date(e.createdAt).getTime(),Number(e.product?.bidActiveDuration),{_id:e._id,date:v(e.createdAt),buyer:Y(e.buyer),avatar:e?.product?.image,product:e.product.title,productId:E,productBuyerId:Q,delivery:v(e.earliestDeliveryDate||e.product?.paymentAndDelivery?.ex_deliveryDate)||"N/A",location:e?.location||e.product?.paymentAndDelivery?.organizationAddress||"N/A",min_budget:e?.product?.minimumBudget,your_budget:e?.budgetQuation,status:e?.closedDealStatus==="waiting_seller_approval"||e?.closedDealStatus==="pending"?"Waiting for seller approval":e?.closedDealStatus==="rejected"?"Rejected":"Deal Closed"}});c(k),T(o),C(L)}},[s]);async function F(a){await S(a)}return r.useEffect(()=>{if(g){z.success("Bid deleted successfully");const a=i.filter(o=>o._id!==p);c(a),m(null)}},[g]),t.jsxs(t.Fragment,{children:[t.jsx(M,{loading:f,setOpen:u,open:j,message:B,deleteFunction:()=>{F(p)}}),A&&!s?t.jsx(H,{}):t.jsx(J,{data:i,columns:P,filters:!0,title:"Quotes Submitted",colorPalette:"gray",page:d,setPage:w,total:_,limit:l,setSearch:I,search:h,isPending:K})]})};export{me as default};
