import{aa as D,n as B,N as _,r,z as i,j as e,s as w,v as I,w as q,Q as P,y as C,ab as S,ac as k,ad as z,ae as R,af as K,ag as L,B as E}from"./index-B0fSYRYK.js";import{B as O}from"./banknote-BbRUH0D_.js";const M=()=>{const u=D(),o=B(),{requirementId:l}=_(),n=u.state?.products||[],[c,x]=r.useState(null),[p,h]=r.useState([]),[g,f]=r.useState([]),[d,N]=r.useState(null),[b,m]=r.useState(!0);r.useEffect(()=>{(async()=>{if(l)try{const t=await z.getRequirementById(l);N(t),m(!1)}catch(t){console.error("Error fetching requirement data:",t),m(!1)}})()},[l]),r.useEffect(()=>{if(d){const a=d||(n&&n.length>0?n[0]:null);if(a){if(x(a),a.product){const t=[a.product,...a.product.subProducts||[]];f(t)}if(a.sellers&&a.sellers.length>0){const t=a.sellers.map(s=>({avtar:s.seller?.profileImage||"https://github.com/shubhamsharma20007.png",date:s.date?i(s.date):s.createdAt?i(s.createdAt):a.createdAt?i(a.createdAt):"N/A",bid_buy:`${s.seller?.firstName||""} ${s.seller?.lastName||""}`.trim()||"Anonymous Seller",bid_amount:s.budgetAmount?`â‚¹${s.budgetAmount}`:"N/A",chat_message:s.message||"Interested in your requirement",action:"chat",sellerId:s.seller?._id||s._id||s.userId}));h(t)}}}},[d,n]);const j=(a,t,s)=>{c&&(localStorage.setItem("chatIds",JSON.stringify({productId:c.product?._id,buyerId:c.buyer?._id,sellerId:a})),o("/chat",{state:{productId:c.product?._id,buyerId:c.buyer?._id,sellerId:a,partnerName:t,partnerAvatar:s}}))},v=[{accessorKey:"avtar",header:"",size:60,cell:({row:a})=>{const t=a.original.avtar,s=a.original.bid_buy||"NA",y=s.split(" ").map(A=>A[0]).join("").toUpperCase();return e.jsx("div",{className:"*:data-[slot=avatar]:ring-background flex -space-x-2 *:data-[slot=avatar]:ring-2",children:e.jsxs(R,{className:"w-10 h-10",children:[e.jsx(K,{src:t,alt:s,className:"rounded-full w-full h-full object-cover"}),e.jsx(L,{className:"bg-gray-200 rounded-full flex items-center justify-center text-sm font-semibold",children:y})]})})}},{accessorKey:"date",header:"Date"},{accessorKey:"bid_buy",header:"Bid By"},{accessorKey:"bid_amount",header:"Bid Amount"},{accessorKey:"chat_message",header:"Chat Message"},{accessorKey:"action",header:"Action",cell:({row:a})=>e.jsx(E,{className:"text-sm cursor-pointer text-orange-600 underline",variant:"link",onClick:()=>j(a.original.sellerId,a.original.bid_buy,a.original.avtar),children:"Chat Now"})}];return b?e.jsx("div",{className:"w-full max-w-7xl mx-auto space-y-6 p-4",children:e.jsx("div",{className:"text-center",children:"Loading..."})}):c?e.jsxs("div",{className:"w-full max-w-7xl mx-auto space-y-3 p-4",children:[e.jsx(w,{className:"sm:block hidden",children:e.jsx(I,{children:e.jsxs(q,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>o(-1),children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx(C,{className:"capitalize font-semibold text-gray-500 text-[15px]",children:"Requirement Detail's"})]})})}),g.map((a,t)=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6  p-4",children:[e.jsx("div",{className:"lg:col-span-4 bg-gray-100 flex justify-center items-center rounded-lg p-4 h-48",children:e.jsx("img",{src:a.image||"/no-image.webp",alt:a.title||"Product",className:"object-contain h-full w-full rounded-lg mix-blend-darken"})}),e.jsxs("div",{className:"lg:col-span-8 p-4 space-y-2",children:[e.jsxs("h2",{className:"text-sm font-medium mb-2",children:["Date: ",i(a.createdAt)||"N/A"]}),e.jsx("h2",{className:"text-xl font-bold capitalize",children:a.title||"N/A"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description||"No description available"}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2 pr-3 border-r-2 py-1",children:[e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(O,{className:"w-5 h-5"}),e.jsx("span",{className:"capitalize",children:"Quantity:"})]}),e.jsx("span",{className:"font-semibold",children:a.quantity||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{className:"capitalize",children:"Delivery By:"})]}),e.jsx("span",{className:"font-semibold",children:a.paymentAndDelivery?.ex_deliveryDate?i(a.paymentAndDelivery.ex_deliveryDate):"N/A"})]})]}),a.brand&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium",children:"Brand:"}),e.jsx("span",{className:"text-gray-600 capitalize",children:a.brand})]}),a.conditionOfProduct&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium",children:"Condition:"}),e.jsx("span",{className:"text-gray-600 capitalize",children:a.conditionOfProduct.replace("_"," ")})]})]})]},t)),e.jsx("div",{className:"bg-orange-50 p-4 rounded-md",children:e.jsx(k,{data:p,columns:v,filters:!1,title:"Available Bids ",target:"requirementOverview",colorPalette:"orange"})})]}):e.jsx("div",{className:"w-full max-w-7xl mx-auto space-y-6 p-4",children:e.jsx("div",{className:"text-center",children:"No product data available"})})};export{M as default};
