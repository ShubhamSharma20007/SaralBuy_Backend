import{d as ce,au as de,u as G,p as te,r as c,a as ie,av as ue,t as j,j as e,F as me,B as ae,f as ne,I as pe,aw as ge,U as y,K as re,X as he,ax as xe,ay as fe}from"./index-nRz7PDd4.js";import{B as be,a as ye,b as je,c as oe,d as ve}from"./breadcrumb-gFg8juDx.js";import{S as w,a as S,b as C,c as F,d as o,D as Ne}from"./DatePicker-DKzNGpRI.js";import{l as we}from"./index-CHCx9Z45.js";import{o as Se,s as Ce,c as Fe,b as Ae,f as Ie,a as Pe,h as _e,e as Te,d as Ve,v as Be,S as Me,C as Oe,I as Z,F as qe,g as le}from"./imageSizer-D-xJSuCj.js";import{C as ke}from"./CustomSkeletons-D9FdukaD.js";import{T as $e}from"./TooltipComp-eQaeTgpE.js";import{M as Ee}from"./move-left-DmJWLqcQ.js";import"./index-DwGfctKw.js";import"./index-CppV2h3m.js";import"./check-B8w4PIHT.js";import"./chevron-up-DirSqPcx.js";import"./calendar-days-u-qCTdjE.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],ze=ce("file",Le),Re={automobile:"automobileFormImage.png",fashion:"fashionFormImage.png",electronics:"electronicsFormImage.png",home:"homeapplianceFormImage.png",sports:"sportsFormImage.png",furniture:"furnitureFormImage.png",health:"healthFormImage.png",beauty:"beautyFormImage.png",service:"servicesFormImage.png",industrial:"constructionFormImage.png",others:"otherImage.webp"};function De(v){switch(v){case"automobile":return Be;case"fashion":return Ve;case"electronics":return Te;case"home":return _e;case"sports":return Pe;case"furniture":return Ie;case"beauty":return Ae;case"industrial":return Fe;case"service":return Ce;case"others":return Se;default:return[]}}const Ue=({formIndex:v,currentCategoryName:d,catByIdData:A,subCategroies:J,subCategoriesData:I,onFormDataChange:M,initialData:t=null})=>{const[Q,L]=c.useState(t?.paymentAndDelivery?.ex_deliveryDate?new Date(t.paymentAndDelivery.ex_deliveryDate):void 0),[g,z]=c.useState([parseFloat(t?.oldProductValue?.min||"0"),parseFloat(t?.oldProductValue?.max||"2")]),[f,H]=c.useState(null),[_,P]=c.useState(null),[u,O]=c.useState(t?.brand||""),[T,Y]=c.useState(""),[K,k]=c.useState([]),$=c.useRef(null),R=c.useRef(null),{watch:x,setValue:i,register:b,getValues:q}=pe({resolver:ge(fe),defaultValues:{title:t?.title||"",quantity:t?.quantity||"",subCategoryId:t?.subCategoryId||"",minimumBudget:t?.minimumBudget||"",productType:t?.productType||"",oldProductValue:{min:t?.oldProductValue?.min||"",max:t?.oldProductValue?.max||""},productCondition:t?.productCondition||"",image:t?.image||"",document:t?.document||"",description:t?.description||"",paymentAndDelivery:{ex_deliveryDate:t?.paymentAndDelivery?.ex_deliveryDate||void 0,paymentMode:t?.paymentAndDelivery?.paymentMode||"",gstNumber:t?.paymentAndDelivery?.gstNumber||"",organizationName:t?.paymentAndDelivery?.organizationName||"",organizationAddress:t?.paymentAndDelivery?.organizationAddress||""},draft:t?.draft||!1,gst_requirement:t?.paymentAndDelivery?.gstNumber?"yes":"",brand:t?.brand||"",additionalDeliveryAndPackage:t?.additionalDeliveryAndPackage||"",gender:t?.gender||"",typeOfAccessories:t?.typeOfAccessories||"",fuelType:t?.fuelType||"",model:t?.model||"",color:t?.color||"",transmission:t?.transmission||"",conditionOfProduct:t?.conditionOfProduct||"",toolType:t?.toolType||"",rateAService:t?.rateAService||"",brandName:t?.brandName||"",typeOfVehicle:t?.typeOfVehicle||"",typeOfProduct:t?.typeOfProduct||""}}),D=x("gst_requirement"),B=x("productType"),U=x("subCategoryId"),W=x("paymentAndDelivery.paymentMode");x("additionalDeliveryAndPackage");const X=x("gender");x("typeOfAccessories");const ee=x("fuelType"),se=x("color"),n=x("transmission"),a=x("conditionOfProduct"),h=x("toolType"),m=x("rateAService");c.useEffect(()=>{const s=x(()=>{const r={...q(),image:f,document:_,formIndex:v,_id:t?._id,initialData:t};M(v,r)});return()=>s.unsubscribe()},[x,f,_,v,M,q,t]),c.useEffect(()=>{i("oldProductValue.min",g[0].toString()),i("oldProductValue.max",g[1].toString())},[g,i]),c.useEffect(()=>{i("brand",u)},[u,i]),c.useEffect(()=>{u!=="others"?i("brandName",""):u==="others"&&t?.brandName&&i("brandName",t.brandName)},[u,i,t?.brandName]),c.useEffect(()=>{if(t?.subCategoryId&&A){const s=A?.subCategories.find(l=>l._id===t.subCategoryId)?.name||"N/A",r=I.find(l=>l.category.replace(/\s+/g,"").toLowerCase()===s.replace(/\s+/g,"").toLowerCase())?.brands;Y(s),r?.length>0&&k(r)}},[t,A,I]);const p=s=>{s&&window.open(s,"_blank")};return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 lg:col-span-1 bg-transparent  border-0 p-6 xs:grid xs:grid-cols-2 gap-6 space-y-4",children:[e.jsxs("div",{className:"col-span-1 align-center sm:block flex flex-col justify-center",children:[e.jsx("h2",{className:"text-[15px] font-semibold mb-2 text-center",children:"Tell us about your need"}),e.jsx("p",{className:"text-[13px] text-muted-foreground text-center",children:"Update your product details below. Make sure all required fields are filled correctly."})]}),e.jsx("div",{className:"col-span-1 w-full",children:e.jsx("img",{src:"/categoryFormImages/"+Re[d],alt:"",loading:"lazy",className:"m-auto w-full"})})]}),e.jsxs("div",{className:"col-span-2 md:col-span-2 flex flex-col gap-3",children:[e.jsx("div",{className:" rounded-[5px] p-6  bg-gray-200/50",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[e.jsx(y,{type:"text",placeholder:"Title*",className:"bg-white col-span-1 md:col-span-3",...b("title")}),e.jsxs(w,{value:U,onValueChange:s=>{const r=A?.subCategories.find(N=>N._id===s)?.name||"N/A",l=I.find(N=>N.category.replace(/\s+/g,"").toLowerCase()===r.replace(/\s+/g,"").toLowerCase())?.brands;l?.length>0&&k(l),i("subCategoryId",s)},children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Category*"})}),e.jsx(F,{children:A&&J.map(s=>e.jsx(o,{value:s._id,children:s.name},s._id))})]}),d!=="service"&&d!=="others"&&e.jsx(Me,{disbaled:!U,setValue:O,value:u,className:"w-full",dropdownTitle:"Brands*",renderItems:K}),d==="others"&&e.jsx(y,{type:"text",placeholder:"Brand Name...",value:u,onChange:s=>{O(s.target.value)},className:"bg-white"}),d!=="others"&&u==="others"&&e.jsx(y,{type:"text",placeholder:"Specific Brand Name...",...b("brandName"),className:"bg-white"}),u==="others"&&e.jsx(y,{type:"text",placeholder:"Specific Brand Name...",...b("brandName"),className:"bg-white"}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:"absolute top-1/2 left-2 text-sm  text-orange-600 font-semibold -translate-y-1/2",children:"â‚¹"}),e.jsx(y,{type:"text",placeholder:"Enter a Budget range ",...b("minimumBudget"),className:"bg-white  pl-5"})]}),d!=="service"&&e.jsx(y,{type:"text",placeholder:"Quantity*",...b("quantity"),className:"bg-white col-span-1"}),d==="service"&&e.jsxs(w,{value:m,onValueChange:s=>i("rateAService",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Rate a Service"})}),e.jsxs(F,{children:[e.jsx(o,{value:"good",children:"Good"}),e.jsx(o,{value:"average",children:"Average"}),e.jsx(o,{value:"bad",children:"Bad"})]})]}),d==="fashion"&&e.jsxs(w,{value:X,onValueChange:s=>i("gender",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Gender"})}),e.jsxs(F,{children:[e.jsx(o,{value:"male",children:"Male"}),e.jsx(o,{value:"female",children:"Female"})]})]}),d==="automobile"&&!T.toLowerCase().includes("accessories")&&e.jsxs(e.Fragment,{children:[e.jsxs(w,{value:ee,onValueChange:s=>i("fuelType",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Fuel Type"})}),e.jsxs(F,{children:[e.jsx(o,{value:"petrol",children:"Petrol"}),e.jsx(o,{value:"cng",children:"CNG"}),e.jsx(o,{value:"hybrid",children:"Hybrid"}),e.jsx(o,{value:"electric",children:"Electric"})]})]}),!T.toLowerCase().includes("accessories")&&e.jsx(y,{type:"text",placeholder:"Model",...b("model"),className:"bg-white col-span-1"}),!T.toLowerCase().includes("accessories")&&e.jsx(e.Fragment,{children:e.jsx(y,{type:"text",placeholder:"Color",value:se,onChange:s=>{i("color",s.target.value)}})}),!["scooters","accessories","bicycles","fuelType"].includes(T.toLowerCase())&&e.jsxs(w,{value:n,onValueChange:s=>i("transmission",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Transmission"})}),e.jsxs(F,{children:[e.jsx(o,{value:"automatic",children:"Automatic"}),e.jsx(o,{value:"manual",children:"Manual"})]})]})]}),T==="Commercial and other Vehicle"&&d==="automobile"&&e.jsx(y,{type:"text",placeholder:"Type of Vehicle",...b("typeOfVehicle"),className:"bg-white"}),d!=="automobile"&&e.jsx(y,{type:"text",placeholder:d==="service"?"Service Type":"Product Type",...b("typeOfProduct"),className:"bg-white"}),(d==="furniture"||d==="sports"||d==="automobile"||d==="home"||d==="electronics")&&d!=="service"&&d!=="others"&&e.jsxs(e.Fragment,{children:[(B==="new_product"||B==="")&&e.jsxs(w,{value:B,onValueChange:s=>i("productType",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Product Condition"})}),e.jsxs(F,{children:[e.jsx(o,{value:"new_product",children:"New Product"}),e.jsx(o,{value:"old_product",children:"Old Product"})]})]}),B==="custom"&&e.jsx(y,{type:"text",placeholder:"Enter your product type",className:"bg-white mt-2",onChange:s=>i("productType",s.target.value)}),T.toLowerCase()==="mobile"&&e.jsx(y,{type:"text",placeholder:"Model",...b("model"),className:"bg-white col-span-1"}),B==="old_product"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full max-w-md border-[1.5px] border-gray-200 rounded-lg bg-white p-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs(re,{className:"font-medium text-gray-500 ",children:["Old Product ",e.jsx("sup",{className:"hidden sm:block",children:"(in Years)"})]}),e.jsx(he,{className:"w-4 h-4 text-gray-400 cursor-pointer",onClick:()=>i("productType","new_product")})]}),e.jsx(we.Range,{values:g,step:.1,min:0,max:20,onChange:s=>z(s),renderTrack:({props:s,children:r})=>e.jsxs("div",{...s,className:"h-1 w-full bg-gray-300 rounded relative",children:[e.jsx("div",{className:"absolute h-1 bg-orange-600 rounded",style:{left:`${g[0]/20*100}%`,width:`${(g[1]-g[0])/20*100}%`}}),r]}),renderThumb:({props:s})=>e.jsx("div",{...s,className:"w-3 h-3 bg-orange-500 rounded-full flex items-center justify-center shadow"})}),e.jsxs("div",{className:"flex justify-between items-center mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"text-gray-600 text-sm hidden sm:block",children:"Min."}),e.jsx("div",{className:"flex items-center gap-1 border rounded px-2 py-1",children:g[0].toString().padStart(2,"0")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-1 border rounded px-2 py-1",children:g[1]}),e.jsx(re,{className:"text-gray-600 text-sm hidden sm:block",children:"Max."})]})]})]})})]}),d==="others"&&e.jsx(e.Fragment,{children:e.jsx(y,{type:"text",placeholder:"Product Condition",...b("productCondition"),className:"bg-white"})}),B==="new_product"&&d==="furniture"&&e.jsxs(w,{value:a,onValueChange:s=>i("conditionOfProduct",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Product Condition"})}),e.jsxs(F,{children:[e.jsx(o,{value:"new",children:"New"}),e.jsx(o,{value:"like_new",children:"Like New"}),e.jsx(o,{value:"excellent",children:"Excellent"}),e.jsx(o,{value:"good",children:"Good"}),e.jsx(o,{value:"fair",children:"Fair"}),e.jsx(o,{value:"poor",children:"Poor"}),e.jsx(o,{value:"for_parts_or_repair",children:"For Parts Or Repair"}),e.jsx(o,{value:"refurbished",children:"Refurbished"}),e.jsx(o,{value:"vintage",children:"Vintage (Used)"}),e.jsx(o,{value:"antique",children:"Antique"})]})]}),d==="industrial"&&e.jsxs(w,{value:h,onValueChange:s=>i("toolType",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Tool Type"})}),e.jsxs(F,{children:[e.jsx(o,{value:"industrial_tool",children:"Industrial Tool"}),e.jsx(o,{value:"machinery_tool",children:"Machinery Type"})]})]})]})}),e.jsxs("div",{className:"rounded-[5px] p-6  bg-gray-200/50",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold  text-gray-700",children:"Other Details"}),e.jsx("sup",{className:"italic text-gray-500",children:"Product Image and document are not mandatory."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{onClick:()=>$?.current?.click(),className:"border-2 border-dashed relative border-gray-300 rounded-lg flex bg-transparent flex-col items-center justify-center p-6 cursor-pointer h-32",children:[e.jsx(Oe,{className:"h-6 w-6 mb-2 text-gray-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Upload Image"}),e.jsx("p",{className:"text-xs text-gray-500 ",children:"to upload your image (max 2 MB)"}),e.jsx("input",{type:"file",accept:"image/*",hidden:!0,ref:$,onChange:s=>{if(s.target.files?.[0]){const r=s.target.files[0];if(r.size>2*1024*1024){j.info("Image size should not exceed 2MB");return}H(r);const l={...q(),image:r,document:_,formIndex:v,_id:t?._id};M(v,l)}}}),f&&e.jsx("p",{className:"text-xs mt-2 text-green-600 text-center",children:f?.name}),f&&e.jsx("div",{className:"absolute h-16 w-16 right-2 top-2  select-none z-10",children:e.jsx("img",{onMouseEnter:s=>Z(s.target),onMouseLeave:s=>Z(s.target),src:URL.createObjectURL(f),className:"h-full w-full object-contain imageSizer",alt:""})}),!f&&t?.image&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"absolute h-16 w-16 right-2 top-2   select-none z-10  ",children:e.jsx("img",{onMouseEnter:s=>Z(s.target),onMouseLeave:s=>Z(s.target),src:f||t?.image,className:" w-full h-full object-contain bg-white  imageSizer  "})})})]}),e.jsxs("div",{onClick:()=>R.current?.click(),className:"border-2 relative border-dashed border-gray-300 rounded-lg flex bg-transparent flex-col items-center justify-center p-6 cursor-pointer",children:[e.jsx(qe,{className:"h-6 w-6 mb-2 text-gray-500"}),e.jsxs("span",{className:"text-sm text-muted-foreground text-center ",children:[e.jsx("span",{className:"font-semibold",children:"Browse From Device"})," ",e.jsx("br",{}),e.jsx("span",{className:"text-xs",children:"to upload your doc/pdf (max 5 MB)"})]}),e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",hidden:!0,ref:R,onChange:s=>{if(s.target.files?.[0]){const r=s.target.files[0];if(r.size===0){j.error("Invalid Doc");return}if(r.size>5*1024*1024){j.info("Document size should not exceed 5MB");return}P(r);const l={...q(),image:f,document:r,formIndex:v,_id:t?._id};M(v,l)}}}),_&&e.jsx("p",{className:"text-xs mt-2 text-green-600",children:_.name}),!_&&t?.document&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-1 right-1 z-10 bg-orange-50 text-orange-400 rounded-sm p-1 cursor-pointer",onClick:()=>p(t?.document),children:e.jsx($e,{hoverChildren:e.jsx(ze,{className:"h-5 w-5"}),contentChildren:e.jsx("p",{children:"Document Download"})})}),e.jsx("p",{className:"text-xs mt-2 text-blue-600",children:"Current document uploaded"})]})]})]}),e.jsx(xe,{placeholder:"Description*",...b("description"),className:"bg-white min-h-24"})]}),e.jsxs("div",{className:"rounded-[5px] p-6  bg-gray-200/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Payment & Delivery Details"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[e.jsx(Ne,{date:Q,title:"Delivery Date",disabledBeforeDate:new Date(new Date().getTime()),setDate:s=>{s&&(L(s),i("paymentAndDelivery.ex_deliveryDate",s))}}),e.jsxs(w,{value:W,onValueChange:s=>i("paymentAndDelivery.paymentMode",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"Payment Mode"})}),e.jsxs(F,{children:[e.jsx(o,{value:"cash",children:"Cash"}),e.jsx(o,{value:"card",children:"Banking or Online mode"}),e.jsx(o,{value:"upi",children:"Any"})]})]}),e.jsxs(w,{value:D,onValueChange:s=>i("gst_requirement",s),children:[e.jsx(S,{className:"w-full bg-white",children:e.jsx(C,{placeholder:"GST Input Required"})}),e.jsxs(F,{children:[e.jsx(o,{value:"yes",children:"Yes"}),e.jsx(o,{value:"no",children:"No"})]})]}),D==="yes"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"text",placeholder:"GST Number",...b("paymentAndDelivery.gstNumber"),className:"bg-white"}),e.jsx(y,{type:"text",placeholder:"Entity Name",...b("paymentAndDelivery.organizationName"),className:"bg-white"}),e.jsx(y,{type:"text",placeholder:"Entity Address",...b("paymentAndDelivery.organizationAddress"),className:"bg-white"})]})]})]})]})]})})},as=()=>{const{productId:v}=de(),{fn:d,data:A,loading:J}=G(te.getDraftById),[I,M]=c.useState(null),t=ie(),[Q,L]=c.useState([]),[g,z]=c.useState([]),[f,H]=c.useState({}),{fn:_,data:P}=G(ue.getCategoriesById),[u,O]=c.useState(null),[T,Y]=c.useState(!1),{fn:K,data:k,loading:$}=G(te.updateDrafts),{fn:R,data:x,loading:i}=G(te.saveAsDraft),[b,q]=c.useState([]),[D,B]=c.useState(!1);c.useEffect(()=>{v&&d(v)},[v]),c.useEffect(()=>{if(A){const n=A;if(M(n),O(n?.categoryId?.categoryName),n?.categoryId?._id&&_(n.categoryId._id),n?.subProducts&&n?.subProducts.length>0){const a=n.subProducts.map((h,m)=>m);z(a)}else z([0])}},[A]);const U=n=>{const a=/^\d{2}[A-Z]{5}\d{4}[A-Z]{1}[A-Z\d]{1}[Z]{1}[A-Z\d]{1}$/,h=Object.values(n);for(let m=0;m<h.length;m++){const p=h[m];if(console.log(p),!p.title||p.title.trim()==="")return j.error(`Title is required${h.length>1?` in product form (${m+1})`:""}`),!1;if(!p.subCategoryId||p.subCategoryId.trim()==="")return j.error(`Category is required${h.length>1?` in product form (${m+1})`:""}`),!1;if(u?.toLowerCase()!=="service"&&(!p.brand||p.brand.trim()===""))return j.error(`Brand is required${h.length>1?` in product form (${m+1})`:""}`),!1;if(!p.minimumBudget||p.minimumBudget<0)return j.error(`Budget range is required${h.length>1?` in product form (${m+1})`:""}`),!1;if(u?.toLowerCase()!=="service"&&(!p.quantity||p.quantity.toString().trim()===""))return j.error(`Quantity is required${h.length>1?` in product form (${m+1})`:""}`),!1;if(!p.description||p.description.trim()==="")return j.error(`Description is required${h.length>1?` in product form (${m+1})`:""}`),!1;if(g[m].gst_requirement==="yes"&&g[m].paymentAndDelivery?.gstNumber){const s=g[m].paymentAndDelivery.gstNumber.trim();if(!a.test(s))return j.error(`Invalid GST Number format in form ${g.length>1?`${m+1}`:""}. Must be 15 characters (Format: 22AAAAA0000A1Z5)`),!1}}return!0};c.useEffect(()=>{if(P){try{const n=u.toLowerCase();q(De(n)),O(n||null)}catch(n){console.error("Error decoding category name:",n),O(null)}L(P?.subCategories||[])}},[P]),c.useEffect(()=>{P&&L(P.subCategories||[])},[P]);const W=(n,a)=>{H(h=>({...h,[n]:a}))},X=async()=>{if(!U(f))return;const n=le(u),a=new FormData,h=[];for(const[p,s]of Object.entries(f)){if(s.quantity){const r=s.quantity.toString().trim();if(!/^\d+$/.test(r)||parseInt(r)<1){j.error(`Invalid Quantity in Form ${parseInt(p)+1}.`);return}}if(s.minimumBudget){const r=s.minimumBudget.toString().trim();if(!/^\d+$/.test(r)||parseInt(r)<1){j.error(`Invalid Budget Range in Form ${parseInt(p)+1}.`);return}}}Object.entries(f).forEach(([p,s])=>{console.log(s);const r={_id:s._id};n.forEach(l=>{if(l==="image"||l==="document"||(l==="oldProductValue"||l==="productCondition")&&s.productType!=="old_product")return;const N=s[l];N!=null?typeof N=="object"?r[l]=JSON.stringify(N):r[l]=N:r[l]=""}),h.push(r),s.image&&n.includes("image")&&a.append("image",s.image),s.document&&n.includes("document")&&a.append("document",s.document)}),a.append("products",JSON.stringify(h)),a.append("draft","false"),a.append("createRequirement","true");const m=g.length>1;await K(a,m)},ee=async()=>{const n=le(u),a=new FormData,h=[];for(const[s,r]of Object.entries(f)){if(r.quantity){const l=r.quantity.toString().trim();if(!/^\d+$/.test(l)||parseInt(l)<1){j.error(`Invalid Quantity in Form ${parseInt(s)+1}.`);return}}if(r.minimumBudget){const l=r.minimumBudget.toString().trim();if(!/^\d+$/.test(l)||parseInt(l)<1){j.error(`Invalid Budget Range in Form ${parseInt(s)+1}.`);return}}}const m=[];Object.entries(f).forEach(([s,r])=>{const l={_id:r._id};n.forEach(V=>{if(V==="image"||V==="document"||(V==="oldProductValue"||V==="productCondition")&&r.productType!=="old_product")return;const E=r[V];E!=null?typeof E=="object"?l[V]=JSON.stringify(E):l[V]=E:l[V]=""}),h.push(l);const N={formIndex:parseInt(s),hasImage:!1,hasDocument:!1};r.image&&n.includes("image")&&(a.append("image",r.image),N.hasImage=!0),r.document&&n.includes("document")&&(a.append("document",r.document),N.hasDocument=!0),m.push(N)}),a.append("products",JSON.stringify(h)),a.append("draft","true"),a.append("createRequirement","false"),a.append("fileMapping",JSON.stringify(m));const p=g.length>1;await R(a,p)};c.useEffect(()=>{x&&(j.success("Draft Submitted successfully"),v&&d(v))},[x]),c.useEffect(()=>{k&&(j.success("Draft Submitted successfully"),t(-1))},[k]);const se=n=>{if(!I)return null;if(I.subProducts&&I.subProducts.length>0){const a=I.subProducts[n];return console.log(`Form ${n} initial data (subProduct):`,a),a||null}else{const a=n===0?I:null;return console.log(`Form ${n} initial data (main):`,a),a}};return e.jsxs(e.Fragment,{children:[e.jsx(me,{setOpen:Y,open:T}),e.jsx("div",{className:"w-full max-w-7xl mx-auto p-4 min-h-screen",children:J?e.jsx(ke,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-row sm:justify-between justify-end items-center gap-3 mb-6",children:e.jsx(be,{className:"sm:block hidden",children:e.jsx(ye,{children:e.jsxs(je,{className:"flex items-center gap-2 cursor-pointer",onClick:()=>t(-1),children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx(oe,{className:"capitalize font-semibold text-gray-500",children:"Selected Product"}),e.jsx(ve,{}),e.jsx(oe,{className:"capitalize font-semibold text-orange-600",children:u==="beauty"?"Personal Care":u==="electronics"?"Mobile, Tablet and Wearables":u==="sports"?"Sports & Stationery":u==="home"?"Home Appliances":u==="industrial"?"Industrial & Construction Material":u==="furniture"?"furniture and decor":u})]})})})}),e.jsx("div",{className:"space-y-8",children:g.map((n,a)=>e.jsxs("div",{children:[e.jsx(Ue,{formIndex:a,currentCategoryName:u,catByIdData:P,subCategroies:Q,subCategoriesData:b,onFormDataChange:W,initialData:se(a),resetForm:D}),g.length>-1&&a<g.length-1&&e.jsx("div",{className:"bg-gray-400 w-full h-[2px] my-5"})]},a))}),e.jsxs("div",{className:"flex justify-end gap-3 my-5",children:[e.jsx(ae,{type:"button",onClick:ee,className:"text-white w-32 cursor-pointer bc  border-primary-btn border-2 ",children:i?e.jsx(ne,{className:"w-5 h-5 animate-spin"}):"Save as Draft"}),e.jsx(ae,{type:"button",disabled:$,className:"text-white w-32 cursor-pointer bc border-primary-btn border-2 ",onClick:X,children:$?e.jsx(ne,{className:"w-5 h-5 animate-spin"}):`Submit ${Object.keys(f).length>1?"All":""}`})]})]})})]})};export{as as default};
